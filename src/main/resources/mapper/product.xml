<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="product">
	
	<select id="list" resultType="Item">
		SELECT * 
		FROM items i join CATEGORIES c ON i.CATEGORY_ID = c.CATEGORY_ID
		WHERE user_id = #{userId}
		ORDER BY CREATED_AT DESC
	</select>
	
	
	<insert id="add">
		INSERT INTO items(ID, USER_ID, CATEGORY_ID, TITLE, DESCRIPTION, DELIVERY, PRICE, AMOUNT, VIEWS, BANK_ACCOUNT_NUMBER,IS_DIRECT_DEAL)
		values(items_seq.nextval, #{userId}, #{categoryId}, #{title}, #{description}, #{delivery}, #{price}, #{amount}, #{views},#{bankAccountNumber},#{isDirectDeal})
	</insert>
	
	<delete id="delete">
		DELETE FROM items
		WHERE id = #{id}
	</delete>
	
	<update id="update">
		UPDATE ITEMS
		SET CATEGORY_ID = #{categoryId}
			, TITLE = #{title}
			, DESCRIPTION = #{description}
			, DELIVERY = #{delivery}
			, PRICE = #{price}
			, AMOUNT = #{amount}
			, BANK_ACCOUNT_NUMBER = #{bankAccountNumber}
			, IS_DIRECT_DEAL = #{isDirectDeal}
		WHERE id=#{id}
	</update>
	
	<select id="item" resultType="Item">
		SELECT * FROM ITEMS
		WHERE ID = #{id}
	</select>
	
	<select id="totalList" resultType="Item">
		SELECT * FROM ITEMS i LEFT JOIN USERS u ON (i.USER_ID  = u.id)
		WHERE i.SALES_STATUS = 'available'
		ORDER BY i.CREATED_AT DESC
	</select>
	
</mapper>